<!-----------------------------------------------------------------------------
 -
 - Copyright 2019 IBM Corporation and others.
 -
 - Licensed under the Apache License, Version 2.0 (the "License");
 - you may not use this file except in compliance with the License.
 - You may obtain a copy of the License at
 -
 -     http://www.apache.org/licenses/LICENSE-2.0
 -
 - Unless required by applicable law or agreed to in writing, software
 - distributed under the License is distributed on an "AS IS" BASIS,
 - WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 - See the License for the specific language governing permissions and
 - limitations under the License.
 -
 ------------------------------------------------------------------------------>


<div id="content">
    <div id="command_title">
        
        server package
    </div>

    <!-- Command content section -->
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Packages an Open Liberty server, its resources, and applications in a compressed file that you can store, distribute, or deploy to a different location.</p>
</div>
<div class="paragraph">
<p>You can select the parts of your Open Liberty server installation to package. You can package an application with a full or a minimal Open Liberty runtime environment, or without an Open Liberty runtime environment so that the application can be deployed on an existing Open Liberty installation.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="usage-examples">Usage examples</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To generate a ZIP file, <code>myserver.zip</code>, that includes all files in the Open Liberty installation directory with the <code>myserver</code> server files:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>server package myserver --include=all</pre>
</div>
</div>
<div class="paragraph">
<p>To generate a ZIP file named <code>package_myserver.zip</code> that has only the <code>myserver</code> server files for deployment on an existing Open Liberty runtime installation, such as in a Docker container:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>server package myserver --archive=package_myserver.zip --include=usr</pre>
</div>
</div>
<div class="paragraph">
<p>To generate a runnable JAR file of <code>myserver</code> named <code>myserver.jar</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>server package myserver --include=runnable</pre>
</div>
</div>
<div class="paragraph">
<p>To generate a minimal runnable JAR file of <code>myserver</code> named <code>package_myserver.jar</code> to the <code>c:\my temp</code> directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>server package myserver --archive="c:\my temp\package_myserver.jar" --include=minify,runnable</pre>
</div>
</div>
<div class="paragraph">
<p>To package a server that supports only Linux:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>server package myserver --archive=linux.zip --include=minify --os=Linux</pre>
</div>
</div>
<div class="paragraph">
<p>To package a server with Linux support, but no Windows support:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>server package myserver --archive=small.zip --include=minify --os=Linux,-Win32</pre>
</div>
</div>
<div class="paragraph">
<p>To generate a ZIP file, <code>myserver.zip</code>, with the root folder named <code>mywlp</code> instead of <code>wlp</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>server package myserver --server-root="mywlp"</pre>
</div>
</div>
<div class="paragraph">
<p>To package the Open Liberty runtime into a ZIP file, <code>wlp.zip</code>, that does not include the <code>usr</code> directory, so has no servers or applications:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>server package --include=wlp</pre>
</div>
</div>
<div class="paragraph">
<p>To package the Open Liberty runtime into a ZIP file named <code>myPackage.zip</code> and put it in <code>c:\temp</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>server package --include=wlp --archive=c:\temp\myPackage.zip</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="syntax">Syntax</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Run the command from the <code>/wlp/bin</code> directory. To package a server, stop the server before running the command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>server package serverName [options]</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">serverName</dt>
<dd>
<p>The name of the server to run the command against. A server name is needed to package a server. A server name is not needed to package the Liberty runtime.</p>
</dd>
<dt class="hdlist1">options</dt>
<dd>
<p>One or more optional parameters.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="options">Options</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--archive="package_file_name.zip"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a target file for the package operation. This path can be either a relative path, which is relative to the installation root directory of Open Liberty, or an absolute path. The default archive target is a ZIP file with the server name, which is stored in the installation root directory. Use quotation marks if the value contains spaces.</p>
<p class="tableblock">If you specify a <code>.jar</code> extension, instead of <code>.zip</code>, for your archive file name, the command creates a JAR file. (See also the <code>--include=runnable</code> option.)</p>
<p class="tableblock">If you do not specify a valid package name or target location, the command creates the <code>wlp.zip</code> runtime archive in the <code>$WLP_OUTPUT_DIR</code> location, which is the <code>${wlp.install.dir}/usr/servers</code> directory by default. The target location must exist before running the command. If the target location is <code>c:\temp</code>, the <code>C:\temp</code> directory must exist and have write permission for the command to write the archive to the <code>C:\temp</code> directory.</p>
<p class="tableblock">The resulting file is created by using UTF-8 encoding for entry names, so the tool that you use to open the file must be able to use UTF-8 encoding for entry names. The <code>jar</code> command in a Java SDK uses this format.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--include=all</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Packages all the files in the Open Liberty installation directory. If the <code>${WLP_USER_DIR}</code> and <code>${WLP_OUTPUT_DIR}</code> are defined in the <code>server.env</code> file, the files under them are packaged.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--include=usr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Packages the files in the <code>${WLP_USER_DIR}</code> directory.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--include=wlp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Packages the files in the <code>wlp</code> directory but does not contain the <code>usr</code> directory.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--include=minify</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Packages only those parts of the runtime environment, and files in the <code>${WLP_USER_DIR}</code> directory, that are required to run the server, which minimizes the size of the resulting archive.</p>
<p class="tableblock">The parts of the runtime environment that are retained by the minify operation depend on the features that are configured in the server that you are packaging. Only those features that are required to run the server are retained, and the remaining features are removed. Therefore, you cannot later enable a feature that has been removed. For example, if only the <code>servlet-3.0</code> feature is retained, you cannot later enable the <code>jpa-2.0</code> feature.</p>
<p class="tableblock">You can repeat the minify operation to further reduce the size of the archive if the configuration is changed. There is, however, no reverse operation for the minify operation, so if you later require one or more features that have been removed, you must begin again with a complete Open Liberty server.</p>
<p class="tableblock">While the minify operation is running, the server is temporarily started, and you see the associated messages. For this reason, you cannot use the <code>--include=minify</code> option with a server that is not able to be started, but you can package it with the <code>--include=all</code> or <code>--include=usr</code> options.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--include=runnable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use only with the <code>--archive="package_file_name.jar"</code> option. Packages an executable JAR file from which you can start an Open Liberty server by running the JAR file. See <a href="runnablejarfiles.html">Runnable JAR files</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">--os=os_value,os_value,&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use only with the <code>--include=minify</code> option. Specifies the operating systems that you want the packaged server to support. Supply a comma-separated list. The default value is any, indicating that the server is to be deployable to any operating system supported by the source.</p>
<p class="tableblock">To specify that an operating system is not to be supported, prefix it with a minus sign (-). For a list of operating system values, refer to the <a href="https://www.osgi.org/developer/specifications/reference/#os">OSGi Alliance website</a>. If you exclude an operating system, you cannot later include it if you repeat the minify operation on the archive.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="see-also">See also</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="runnablejarfiles.html">Runnable JAR files</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="exit-codes">Exit codes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following exit codes are available for the <code>server</code> command and the equivalent executable JAR file ws-server.jar:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">0</dt>
<dd>
<p>OK. 0 indicates successful completion of the requested operation. For server status, 0 indicates that the server is running.</p>
</dd>
<dt class="hdlist1">1</dt>
<dd>
<p>For server status, 1 indicates that the server is not running. For other operations, it indicates invocation of a redundant operation. For example, starting a started server or stopping a stopped server. This code might also be returned by JVM if invalid Java options are used.</p>
</dd>
<dt class="hdlist1">2</dt>
<dd>
<p>The server does not exist.</p>
</dd>
<dt class="hdlist1">3</dt>
<dd>
<p>An unsupported action was called on a running server. For example, the server is running when the package action is called.</p>
</dd>
<dt class="hdlist1">4</dt>
<dd>
<p>An unsupported action was called on a stopped server. For example, the server is not running when the dump action is called.</p>
</dd>
<dt class="hdlist1">5</dt>
<dd>
<p>Unknown server status. For example, the workarea directory is missing, or the Attach API fails to work.</p>
</dd>
<dt class="hdlist1">&gt;=20</dt>
<dd>
<p>Return codes greater than or equal to 20 indicate that an error occurred while performing the request. Messages are printed and captured in log files with more information about the error.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
